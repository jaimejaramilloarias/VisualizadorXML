<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Verovio + Playhead + Reproducción MIDI</title>
  <!-- Verovio (WASM global) -->
  <script src="https://www.verovio.org/javascript/latest/verovio-toolkit-wasm.js" defer></script>
  <!-- soundfont-player (v0.12.0). Si el CDN falla, el runtime intentará otros mirrors -->
  <script src="https://cdn.jsdelivr.net/npm/soundfont-player@0.12.0/dist/soundfont-player.min.js" defer></script>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
<div class="app">
  <header>
    <div class="group">
      <label for="scoreFile">Partitura</label>
      <input id="scoreFile" type="file" accept=".mei,.xml,.musicxml,.mxl,.zip" />
    </div>
    <div class="group">
      <button id="playBtn" class="primary" disabled>▶︎ Reproducir MIDI</button>
      <button id="stopBtn" disabled>■</button>
    </div>
    <div class="group">
      <label for="offset">Offset (ms)</label>
      <input id="offset" type="number" step="1" value="0" style="width:6rem" />
      <input id="offsetRange" type="range" min="-4000" max="4000" step="1" value="0" />
      <button id="tapAlignBtn" title="Haz clic en una nota para alinear offset">Alinear por clic</button>
    </div>
    <div class="group">
      <label for="zoom">Zoom</label>
      <input id="zoom" type="range" min="30" max="160" value="100" />
      <span id="zoomVal" class="pill">100%</span>
      <label style="margin-left:.5rem"><input id="follow" type="checkbox" checked /> Seguir página</label>
    </div>
    <div class="group">
      <span class="pill" id="pageInfo">Pág. –/–</span>
      <span class="pill" id="timeInfo">0.000 s</span>
    </div>
  </header>
  <div id="trackControls"></div>

  <div id="score-wrap">
    <div id="score"></div>
  </div>

  <footer>
    <div>Verovio + MIDI (SoundFont) — tira horizontal con playhead y autoscroll.</div>
    <div id="vrvVersion" class="pill">Cargando Verovio…</div>
  </footer>
</div>

<script type="module" src="app.js"></script>
</body>
</html>
